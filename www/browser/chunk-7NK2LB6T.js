import{p as O}from"./chunk-SPESN3BV.js";import"./chunk-MYJO3HAP.js";import"./chunk-AOQDE75R.js";import{A as e,B as d,G as f,O as o,Pa as E,Ra as A,Sa as _,Ta as T,Ua as F,Va as N,Xa as P,Ya as R,Za as L,db as k,ea as C,eb as G,jb as j,ka as s,la as y,ma as I,na as b,nb as M,o as u,oa as w,p as c,pa as v,r as h,sa as S,ta as x,y as g,z as t}from"./chunk-2G2L2QNG.js";import"./chunk-FXM2KW74.js";import"./chunk-NNH6CN3M.js";import"./chunk-HC6MZPB3.js";import"./chunk-4PGTP63H.js";import"./chunk-UKPPH64P.js";import"./chunk-FERD25SW.js";import"./chunk-SYQESB6R.js";import"./chunk-LEIMCQKJ.js";import"./chunk-N3PT3BRI.js";import"./chunk-MM5QLNJM.js";import"./chunk-72KDLSWN.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-5YEN3EPI.js";import"./chunk-MCRJI3T3.js";import"./chunk-PVZQOOQ7.js";import"./chunk-U2CNLB2V.js";import"./chunk-PVOLIMNR.js";import"./chunk-7QLMNM35.js";import"./chunk-FF3P7ZBM.js";import"./chunk-G3CV3VGG.js";import"./chunk-UDRXED5C.js";import"./chunk-FANUMIDU.js";import"./chunk-SB67TZC5.js";import"./chunk-4U6PRYVA.js";import"./chunk-QXT6YJJ4.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as m}from"./chunk-RW4GY4BD.js";var Q=(()=>{let l=class l{constructor(a,i,r){this.fb=a,this.router=i,this.alertController=r,this.registerForm=this.fb.group({name:["",s.required],email:["",[s.required,s.email]],password:["",s.required]})}register(){return m(this,null,function*(){if(this.registerForm.valid){let{name:a,email:i,password:r}=this.registerForm.value;try{let n=yield fetch(`${O}/users/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,email:i,password:r})});if(n.ok){let q=yield n.text(),[D,B]=q.split(","),H=n.headers.get("Authorization");localStorage.setItem("user_id",D),localStorage.setItem("name",B),localStorage.setItem("token",H),window.location.pathname="/"}else n.status===409?this.showAccountExistsAlert():this.showGenericErrorAlert()}catch(n){console.error("API error:",n)}}})}showAccountExistsAlert(){return m(this,null,function*(){yield(yield this.alertController.create({header:"Account Exists",message:"An account with this email already exists.",buttons:[{text:"Cancel",role:"cancel",cssClass:"alert-button-left"},{text:"Login",handler:()=>{this.navigateToLogin()}}]})).present()})}showGenericErrorAlert(){return m(this,null,function*(){yield(yield this.alertController.create({header:"Registration Failed",message:"An error occurred during registration. Please try again later.",buttons:["OK"]})).present()})}navigateToLogin(){this.router.navigate(["/login"])}};l.\u0275fac=function(i){return new(i||l)(c(S),c(C),c(j))},l.\u0275cmp=h({type:l,selectors:[["app-register"]],decls:28,vars:2,consts:[[1,"card-container"],[3,"ngSubmit","formGroup"],["position","floating"],["formControlName","name"],["formControlName","email","type","email"],["formControlName","password","type","password"],["expand","full","type","submit",3,"disabled"],["expand","full","color","light",3,"click"]],template:function(i,r){i&1&&(t(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),o(3,"Register"),e()()(),t(4,"ion-content")(5,"div",0)(6,"ion-card")(7,"ion-card-header")(8,"ion-card-title"),o(9,"Welcome to Tripify"),e()(),t(10,"ion-card-content")(11,"form",1),f("ngSubmit",function(){return r.register()}),t(12,"ion-item")(13,"ion-label",2),o(14,"Name"),e(),d(15,"ion-input",3),e(),t(16,"ion-item")(17,"ion-label",2),o(18,"Email"),e(),d(19,"ion-input",4),e(),t(20,"ion-item")(21,"ion-label",2),o(22,"Password"),e(),d(23,"ion-input",5),e(),t(24,"ion-button",6),o(25,"Register"),e()(),t(26,"ion-button",7),f("click",function(){return r.navigateToLogin()}),o(27,"Already signed in? Login"),e()()()()()),i&2&&(u(11),g("formGroup",r.registerForm),u(13),g("disabled",r.registerForm.invalid))},dependencies:[T,F,_,A,P,G,k,N,E,M,R,L,x,b,y,I,w,v],styles:[".card-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}ion-card[_ngcontent-%COMP%]{width:100%;max-width:500px}"]});let p=l;return p})();export{Q as RegisterPage};
